l_info("Consolidating information on active purse seiners...")

# PURSE SEINERS ####

ACTIVE_PS = copy(ACTIVE_PS_RAW)

# Format the year
ACTIVE_PS[, YEAR := as.integer(YEAR)]

# Remove Japanese purse seiners except for NIPPON MARU for 2002 (Y:\04 - Meetings\05 - Scientific Committee\SC06 - 2003 - Seychelles\Documents\IOTC-SC-03-Inf.4)
ACTIVE_PS = ACTIVE_PS[!(YEAR == 2002 & FLEET == "Japan" & VESSEL_NAME != "NIPPON MARU")]

# Harmonize vessel names
ACTIVE_PS[IOTC_CODE == "IOTC000178", VESSEL_NAME := "JUAN RAMON EGANA"]
ACTIVE_PS[IOTC_CODE == "IOTC000354", VESSEL_NAME := "MEN CREN"]
ACTIVE_PS[IOTC_CODE == "IOTC000367", VESSEL_NAME := "KERSAINT DE COETNEMPREN"]
ACTIVE_PS[IOTC_CODE == "IOTC000358", VESSEL_NAME := "VIA EUROS"]
ACTIVE_PS[IOTC_CODE == "IOTC000139", VESSEL_NAME := "ALBACORA SEIS"]
ACTIVE_PS[IOTC_CODE == "IOTC016208", VESSEL_NAME := "GALERNA II"]    # 2 distinct IOTC numbers!
ACTIVE_PS[IOTC_CODE == "IOTC015856", VESSEL_NAME := "GALERNA III"]
ACTIVE_PS[IOTC_CODE == "IOTC000193", VESSEL_NAME := "TXORI TOKI"]
ACTIVE_PS[IOTC_CODE == "IOTC003874", VESSEL_NAME := "DRENNEC"]
ACTIVE_PS[IOTC_CODE == "IOTC003810", VESSEL_NAME := "TREVIGNON"]
ACTIVE_PS[IOTC_CODE == "IOTC000161", VESSEL_NAME := "ALBACORA CUATRO"]
ACTIVE_PS[IOTC_CODE == "IOTC000171", VESSEL_NAME := "CAMPOLIBRE ALAI"]
ACTIVE_PS[IOTC_CODE == "IOTC000180", VESSEL_NAME := "MAR DE SERGIO"]
ACTIVE_PS[IOTC_CODE == "IOTC001238", VESSEL_NAME := "TAIKEI MARU No.1"]
ACTIVE_PS[IOTC_CODE == "IOTC001371", VESSEL_NAME := "27 HAKKO MARU"]
ACTIVE_PS[IOTC_CODE == "IOTC001579", VESSEL_NAME := "TOMI MARU No.63"]
ACTIVE_PS[IOTC_CODE == "IOTC001729", VESSEL_NAME := "85 FUKUICHI MARU"]
ACTIVE_PS[IOTC_CODE == "IOTC001735", VESSEL_NAME := "86 GENPUKU MARU"]

# Same vessels with two distinct IOTC numbers
#ACTIVE_PS[, .(N = length(unique(IOTC_CODE))), keyby = .(VESSEL_NAME)][N>1]

# Correct obvious error in IOTC numbers
ACTIVE_PS[VESSEL_NAME == "ADRIA" & YEAR %in% 2017, IOTC_CODE := "IOTC000369"]
ACTIVE_PS[VESSEL_NAME == "ALBACAN" & YEAR %in% 2016:2017, IOTC_CODE := "IOTC000159"]
ACTIVE_PS[VESSEL_NAME == "ALBACORA CUATRO" & YEAR %in% 2016:2017, IOTC_CODE := "IOTC000161"]
ACTIVE_PS[VESSEL_NAME == "BELOUVE", `:=` (IOTC_CODE = "IOTC014063", GT = 2667)]
ACTIVE_PS[VESSEL_NAME == "BERNICA", `:=` (IOTC_CODE = "IOTC009828", LOA = 89.4)]
ACTIVE_PS[VESSEL_NAME == "FRANCHE TERRE", `:=` (IOTC_CODE = "IOTC008743", LOA = 89.4, GT = 2664)]
ACTIVE_PS[VESSEL_NAME == "GALERNA II", `:=` (IOTC_CODE = "IOTC016208")]
ACTIVE_PS[VESSEL_NAME == "ITSAS TXORI", `:=` (LOA = 95.8, IOTC_CODE = "IOTC015353")]     # LOA!!! https://www.marinetraffic.com/en/ais/details/ships/shipid:992639/mmsi:225455000/imo:9702869/VESSEL_NAME:ITSAS_TXORI
ACTIVE_PS[VESSEL_NAME == "KOYO MARU NO.88", IOTC_CODE := "IOTC016028"]
ACTIVE_PS[VESSEL_NAME == "MANAPANY", `:=` (IOTC_CODE = "IOTC009131", LOA = 89.4, GT = 2666)]
ACTIVE_PS[VESSEL_NAME == "PLAYA DE ANZORAS", `:=` (IOTC_CODE = "IOTC000186", LOA = 85.5, GT = 2446)]
ACTIVE_PS[VESSEL_NAME == "PLAYA DE ARITZATXU", `:=` (IOTC_CODE = "IOTC000187", LOA = 86.7, GT = 2458)]

ACTIVE_PS[VESSEL_NAME == "PLAYA DE NOJA", `:=` (IOTC_CODE = "IOTC000176", LOA = 77.3, GT = 2110)] #same IOTC number as FELIPE RUANO?

# Harmonize gear and vessel type
ACTIVE_PS[, `:=` (FISHERY_GROUP_CODE = "PS", GEAR = "Purse seine")]
ACTIVE_PS[, VESSEL_TYPE := "Purse seiner"]

# Harmonize LOA and GT
#ACTIVE_PS[, .(LOA_MIN = min(LOA), LOA_MAX = max(LOA), SD_LOA = sd(LOA)), keyby = .(IOTC_CODE, VESSEL_NAME)][SD_LOA>0][order(IOTC_CODE)]
ACTIVE_PS[IOTC_CODE == "IOTC000138", `:=` (LOA = 101.66, GT = 4428)]
ACTIVE_PS[IOTC_CODE == "IOTC000141", `:=` (LOA = 71.35, GT = 2232)]
ACTIVE_PS[IOTC_CODE == "IOTC000143", `:=` (LOA = 71.35, GT = 2232)]
ACTIVE_PS[IOTC_CODE == "IOTC000159", `:=` (LOA = 85.85, GT = 2232)]   # LOA corrected according to RAV ALBACAN
ACTIVE_PS[IOTC_CODE == "IOTC000161", `:=` (LOA = 83.45, GT = 2082)]
ACTIVE_PS[IOTC_CODE == "IOTC000171", `:=` (LOA = 69.61, GT = 2214)]
ACTIVE_PS[IOTC_CODE == "IOTC000172", `:=` (LOA = 109.3, GT = 3674)]
ACTIVE_PS[IOTC_CODE == "IOTC000175", `:=` (LOA = 80, GT = 2217)]
ACTIVE_PS[IOTC_CODE == "IOTC000176", `:=` (LOA = 77.3, GT = 2210)]
ACTIVE_PS[IOTC_CODE == "IOTC000178", `:=` (LOA = 77.3, GT = 2107)]
ACTIVE_PS[IOTC_CODE == "IOTC000180", `:=` (LOA = 84.2, GT = 2767)]
ACTIVE_PS[IOTC_CODE == "IOTC000182", `:=` (LOA = 73.02, GT = 2160)]
ACTIVE_PS[IOTC_CODE == "IOTC000185", `:=` (LOA = 69.2, GT = 2058)]
ACTIVE_PS[IOTC_CODE == "IOTC000188", `:=` (LOA = 75.6, GT = 2101)]
ACTIVE_PS[IOTC_CODE == "IOTC000193", `:=` (LOA = 106.5, GT = 4134)]
ACTIVE_PS[IOTC_CODE == "IOTC000194", `:=` (LOA = 63.3, GT = 1286)]
ACTIVE_PS[IOTC_CODE == "IOTC000195", `:=` (LOA = 73.9, GT = 1823)]
ACTIVE_PS[IOTC_CODE == "IOTC000345", `:=` (LOA = 79.59, GT = 2137)]
ACTIVE_PS[IOTC_CODE == "IOTC000354", `:=` (LOA = 79.8, GT = 2119)]
ACTIVE_PS[IOTC_CODE == "IOTC000365", `:=` (LOA = 81.9, GT = 2255)]
ACTIVE_PS[IOTC_CODE == "IOTC000366", `:=` (LOA = 81.9, GT = 2255)]
ACTIVE_PS[IOTC_CODE == "IOTC000812", `:=` (LOA = 106.5, GT = 4134)]
ACTIVE_PS[IOTC_CODE == "IOTC000815", `:=` (LOA = 78.01, GT = 2020)]  # LOA corrected according to TURBOBAT
ACTIVE_PS[IOTC_CODE == "IOTC000879", `:=` (LOA = 108, GT = 4089)]
ACTIVE_PS[IOTC_CODE == "IOTC000907", `:=` (LOA = 104.3, GT = 3716)]
ACTIVE_PS[IOTC_CODE == "IOTC001238", `:=` (LOA = 56.84, GT = 1096)]
ACTIVE_PS[IOTC_CODE == "IOTC003810", `:=` (LOA = 84.19, GT = 2319)]
ACTIVE_PS[IOTC_CODE == "IOTC003874", `:=` (LOA = 84.12, GT = 2319)]
ACTIVE_PS[IOTC_CODE == "IOTC004935", `:=` (LOA = 67.2, GT = 1817)]
ACTIVE_PS[IOTC_CODE == "IOTC008281", `:=` (LOA = 95.8, GT = 2937)]
ACTIVE_PS[IOTC_CODE == "IOTC015113", `:=` (LOA = 89.4, GT = 2667)]
ACTIVE_PS[IOTC_CODE == "IOTC015115", `:=` (LOA = 89.4, GT = 2667)]
ACTIVE_PS[IOTC_CODE == "IOTC000182", `:=` (LOA = 73.02, GT = 2160)]
ACTIVE_PS[IOTC_CODE == "IOTC000897", `:=` (LOA = 79, GT = 1948)]
ACTIVE_PS[IOTC_CODE == "IOTC000898", `:=` (LOA = 79, GT = 1948)]
ACTIVE_PS[IOTC_CODE == "IOTC000902", `:=` (LOA = 72.5, GT = 1413)]
ACTIVE_PS[IOTC_CODE == "IOTC000903", `:=` (LOA = 79, GT = 1948)]
ACTIVE_PS[IOTC_CODE == "IOTC000904", `:=` (LOA = 85, GT = 2660)]
ACTIVE_PS[IOTC_CODE == "IOTC000905", `:=` (LOA = 85, GT = 2660)]
ACTIVE_PS[IOTC_CODE == "IOTC000136", `:=` (LOA = 67.44, GT = 2167)]
ACTIVE_PS[IOTC_CODE == "IOTC000138", `:=` (LOA = 101.66, GT = 4428)]
ACTIVE_PS[IOTC_CODE == "IOTC000140", `:=` (LOA = 71.35, GT = 2232)]
ACTIVE_PS[IOTC_CODE == "IOTC000141", `:=` (LOA = 71.35, GT = 2232)]
ACTIVE_PS[IOTC_CODE == "IOTC000143", `:=` (LOA = 71.35, GT = 2232)]
ACTIVE_PS[IOTC_CODE == "IOTC000353", `:=` (LOA = 67.3, GT = 1606)]
ACTIVE_PS[IOTC_CODE == "IOTC000357", `:=` (LOA = 78.33, GT = 1737)]
ACTIVE_PS[IOTC_CODE == "IOTC000368", `:=` (LOA = 79.8, GT = 2109)]
ACTIVE_PS[IOTC_CODE == "IOTC000370", `:=` (LOA = 67.3, GT = 1596)]
ACTIVE_PS[IOTC_CODE == "IOTC000373", `:=` (LOA = 67.3, GT = 1598)]
ACTIVE_PS[IOTC_CODE == "IOTC000814", `:=` (LOA = 94.79, GT = 3870)]
ACTIVE_PS[IOTC_CODE == "IOTC003575", `:=` (LOA = 84.1, GT = 2319)]
ACTIVE_PS[IOTC_CODE == "IOTC003606", `:=` (LOA = 84.14, GT = 3296)]
ACTIVE_PS[IOTC_CODE == "IOTC013979", `:=` (LOA = 89.4, GT = 2667)]
ACTIVE_PS[IOTC_CODE == "IOTC014063", `:=` (LOA = 89.4, GT = 2667)]

# Harmonize GT
ACTIVE_PS[IOTC_CODE == "IOTC000346", GT := 957] # TURBOBAT
ACTIVE_PS[IOTC_CODE == "IOTC000347", GT := 729] # TURBOBAT
ACTIVE_PS[IOTC_CODE == "IOTC000348", GT := 828] # TURBOBAT
ACTIVE_PS[IOTC_CODE == "IOTC000349", GT := 807] # TURBOBAT
ACTIVE_PS[IOTC_CODE == "IOTC000350", GT := 840] # TURBOBAT
ACTIVE_PS[IOTC_CODE == "IOTC000351", GT := 959] # TURBOBAT
ACTIVE_PS[IOTC_CODE == "IOTC000352", GT := 959] # TURBOBAT
ACTIVE_PS[IOTC_CODE == "IOTC000361", GT := 957] # TURBOBAT
ACTIVE_PS[IOTC_CODE == "IOTC001765", GT := 1200]  # http://map.seafdec.org/downloads/pdf/Observation%20Report%20on%20Tuna%20Purse%20Seine%20Fishing%20Operation%20around%20Schychelle%20Waters%20Onboard%20Nippon%20Maru%209%20November%201992%20to%207%20January%201993.pdf

# Fill missing values of GT
#ACTIVE_PS[is.na(GT)]
ACTIVE_PS[IOTC_CODE == "IOTC000162", GT := 2165]  # TURBOBAT
ACTIVE_PS[IOTC_CODE == "IOTC000191", GT := 2400]
ACTIVE_PS[IOTC_CODE == "IOTC000353", GT := 1606]
ACTIVE_PS[IOTC_CODE == "IOTC000355", GT := 1558] # TURBOBAT
ACTIVE_PS[IOTC_CODE == "IOTC000356", GT := 1585] # TURBOBAT
ACTIVE_PS[IOTC_CODE == "IOTC000357", GT := 1737]
ACTIVE_PS[IOTC_CODE == "IOTC000358", GT := 1737]
ACTIVE_PS[IOTC_CODE == "IOTC000359", GT := 1737]
ACTIVE_PS[IOTC_CODE == "IOTC000360", GT := 1606]
ACTIVE_PS[IOTC_CODE == "IOTC000362", GT := 1609]
ACTIVE_PS[IOTC_CODE == "IOTC000363", GT := 1600]
ACTIVE_PS[IOTC_CODE == "IOTC000364", GT := 1609]
ACTIVE_PS[IOTC_CODE == "IOTC000367", GT := 1600]
ACTIVE_PS[IOTC_CODE == "IOTC000368", GT := 2109]
ACTIVE_PS[IOTC_CODE == "IOTC000369", GT := 2227]
ACTIVE_PS[IOTC_CODE == "IOTC000370", GT := 1596]
ACTIVE_PS[IOTC_CODE == "IOTC000371", GT := 1383]
ACTIVE_PS[IOTC_CODE == "IOTC000372", GT := 1383]
ACTIVE_PS[IOTC_CODE == "IOTC000373", GT := 1598]
ACTIVE_PS[IOTC_CODE == "IOTC001204", GT := 999] # https://www.balticshipping.com/vessel/imo/8210766
ACTIVE_PS[IOTC_CODE == "IOTC001282", GT := 1096]
ACTIVE_PS[IOTC_CODE == "IOTC000160", `:=` (VESSEL_NAME = "INTERTUNA CUATRO", LOA = 105, GT = 4164)]
ACTIVE_PS[IOTC_CODE == "IOTC000163", GT := 2336]
ACTIVE_PS[IOTC_CODE == "IOTC000163", GT := 2336]
ACTIVE_PS[IOTC_CODE == "IOTC000811", GT := 4406]
ACTIVE_PS[IOTC_CODE == "IOTC000878", GT := 4406]
ACTIVE_PS[IOTC_CODE == "IOTC000897", GT := 1948]
ACTIVE_PS[IOTC_CODE == "IOTC000898", GT := 1948]
ACTIVE_PS[IOTC_CODE == "IOTC000902", GT := 1413]
ACTIVE_PS[IOTC_CODE == "IOTC000903", GT := 1948]
ACTIVE_PS[IOTC_CODE == "IOTC000904", GT := 2660]
ACTIVE_PS[IOTC_CODE == "IOTC000905", GT := 2660]
ACTIVE_PS[IOTC_CODE == "IOTC001396", GT := 1095] # RAV
ACTIVE_PS[IOTC_CODE == "IOTC001579", GT := 1094] # RAV
ACTIVE_PS[IOTC_CODE == "IOTC001729", GT := 1094] # RAV
ACTIVE_PS[IOTC_CODE == "IOTC001752", GT := 1016] # RAV

# Estimate GT from LOA-GT relationship
PS_GT_LOA = unique(ACTIVE_PS[!is.na(GT), .(IOTC_CODE, LOA, GT)])
LM_PS_GT_LOA = lm(GT~LOA, data = PS_GT_LOA)

PS_GT_LOA_PLOT = 
  ggplot(data = PS_GT_LOA, aes(x = LOA, y = GT)) +
  geom_point(color = alpha("red", 0.5)) + 
  labs(x = "Length overall (m)", y = "Gross tonnage (t)") + 
  scale_y_continuous(labels = function(x) prettyNum(x, big.mark = ",")) + 
  theme_bw()

NEWD = data.table(ACTIVE_PS[is.na(GT), .(IOTC_CODE, LOA)])
NEWD[, GT := predict.lm(LM_PS_GT_LOA, NEWD)]

ACTIVE_PS[IOTC_CODE %in% NEWD$IOTC_CODE, GT := NEWD$GT]

# Remove French purse seiners in 2020 that were not active

ACTIVE_PS = ACTIVE_PS[!(YEAR == 2020 & IOTC_CODE %in% c("IOTC000358", "IOTC000359", "IOTC000360", "IOTC000365", "IOTC000366", "IOTC016428", "IOTC016513"))]

# SUPPORT VESSELS ####

ACTIVE_SP = copy(ACTIVE_SP_RAW)

# Format the year
ACTIVE_SP[, YEAR := as.integer(YEAR)]

# Correct error in IOTC number
ACTIVE_SP[IOTC_CODE == "IOTC016116", IOTC_CODE := "IOTC015116"]

# Harmonize names
ACTIVE_SP[, VESSEL_NAME := trimws(VESSEL_NAME)]

# Harmonize gear and vessel type

ACTIVE_SP[, `:=` (GEAR = "Supply Vessel Purse Seiners", FISHERY_GROUP_CODE = "SP")]
ACTIVE_SP[, VESSEL_TYPE := "Supply vessel (purse seiners)"]

# Harmonize LOA and GT
ACTIVE_SP[IOTC_CODE == "IOTC015116", GT := 287]
ACTIVE_SP[IOTC_CODE == "IOTC003590", `:=` (LOA = 40, GT = 420)]
ACTIVE_SP[IOTC_CODE == "IOTC003828", `:=` (LOA = 29.83)]
ACTIVE_SP[IOTC_CODE == "IOTC003599", `:=` (LOA = 38.49, GT = 488)]
ACTIVE_SP[IOTC_CODE == "IOTC000880", `:=` (LOA = 33.9, GT = 264)]
ACTIVE_SP[IOTC_CODE == "IOTC008744", `:=` (LOA = 36, GT = 245)]
ACTIVE_SP[IOTC_CODE == "IOTC000894", `:=` (LOA = 44.05, GT = 393)]
ACTIVE_SP[IOTC_CODE == "IOTC004979", `:=` (LOA = 37.55, GT = 369)]
ACTIVE_SP[IOTC_CODE == "IOTC008298", `:=` (GT = 470)]
ACTIVE_SP[IOTC_CODE == "IOTC000813", `:=` (LOA = 32.16, GT = 315)]
ACTIVE_SP[IOTC_CODE == "IOTC000913", `:=` (LOA = 35.13, GT = 421)]
ACTIVE_SP[IOTC_CODE == "IOTC016462", `:=` (LOA = 34.76)]
ACTIVE_SP[IOTC_CODE == "IOTC004980", `:=` (LOA = 35.2, GT = 193)]
ACTIVE_SP[IOTC_CODE == "IOTC016190", `:=` (LOA = 40, GT = 193)]
ACTIVE_SP[IOTC_CODE == "IOTC016626", `:=` (LOA = 46.3, GT = 497)]

# Correction of GT
ACTIVE_SP[IOTC_CODE == "IOTC004976", `:=` (GT = 235)]   #https://www.vesselfinder.com/vessels/details/9156929

# LONGLINERS ####

ACTIVE_LL_AVL = copy(ACTIVE_LL_RAW)

# Format the year
ACTIVE_LL_AVL[, YEAR := as.integer(YEAR)]

ACTIVE_LL_AVL[, GEAR := toupper(GEAR)]
ACTIVE_LL_AVL[, VESSEL_TYPE := toupper(VESSEL_TYPE)]

ACTIVE_LL_AVL[VESSEL_NAME == "No. 638 DONG WON", IOTC_NUMBER := 1381]
ACTIVE_LL_AVL[VESSEL_TYPE == "LC", `:=` (GEAR = "LL", VESSEL_TYPE = "LL")]
ACTIVE_LL_AVL[VESSEL_TYPE == "LI", `:=` (GEAR = "LL", VESSEL_TYPE = "LL")]
ACTIVE_LL_AVL[VESSEL_TYPE == "MU", `:=` (GEAR = "LL", VESSEL_TYPE = "LL")]

# REMOVE PS and SP from AVL when GEARS and VESSEL_TYPE are unknown
# 1287 = used as IOTC number for the Japanese purse seiner "18 TAIJIN MARU" but also for a longliner
IOTC_NUMBERS_PS_SP = sort(unique(rbindlist(list(ACTIVE_PS, ACTIVE_SP))[IOTC_NUMBER != 1287, IOTC_NUMBER]))

ACTIVE_LL = ACTIVE_LL_AVL[!IOTC_NUMBER %in% IOTC_NUMBERS_PS_SP]

#ACTIVE_LL[, VESSEL_NAME := trimws(toupper(VESSEL_NAME))]

# Harmonize names and attributes
ACTIVE_LL[IOTC_NUMBER == "900042645", `:=` (VESSEL_NAME = "FENG GUO NO.168", GEAR = "LL", VESSEL_TYPE = "LL", LOA = 27.9, GT = 95)]

ACTIVE_LL[IOTC_NUMBER == "900051740", `:=` (VESSEL_NAME = "HO HSIN HSING NO.601", GEAR = "LL", VESSEL_TYPE = "LL", FLEET_CODE = "TWN", LOA = 36, GT = 199)]    # harmonizing to TWN while reported as both CHN and TWN in 2014

ACTIVE_LL[IOTC_NUMBER == "900051740", `:=` (VESSEL_NAME = "HO HSIN HSING NO.601", GEAR = "LL", VESSEL_TYPE = "LL", FLEET_CODE = "TWN", LOA = 36, GT = 199)]    # harmonizing to TWN while reported as both CHN and TWN in 2014

ACTIVE_LL[YEAR == 2015 & VESSEL_TYPE == "UN", `:=` (GEAR = "LL", VESSEL_TYPE = "LL")]
ACTIVE_LL[YEAR>=2015, .N, keyby = .(GEAR)]

# Update VESSEL_TYPE based on GEAR
ACTIVE_LL[YEAR<2015 & GEAR == "LL" & VESSEL_TYPE == "UN", `:=` (GEAR = "LL", VESSEL_TYPE = "LL")]

## Use information from vessel type when known to update UNKNOWN VESSEL_TYPE
IOTC_NUMBERS_LONGLINERS = unique(ACTIVE_LL[VESSEL_TYPE == "LL", IOTC_NUMBER])

ACTIVE_LL[VESSEL_TYPE == "UN" & IOTC_NUMBER %in% IOTC_NUMBERS_LONGLINERS, `:=` (GEAR = "LL", VESSEL_TYPE = "LL")]

# Remove all Iranian vessels of unknown vessel type, suspected to be gillnetters
ACTIVE_LL = ACTIVE_LL[!(VESSEL_TYPE == "UN" & FLEET_CODE == "IRN")]

# Remove all Maldivian vessels of unknown vessel type suspected to be baitboats
ACTIVE_LL = ACTIVE_LL[!(VESSEL_TYPE == "UN" & FLEET_CODE == "MDV")]

# Add gear_code
ACTIVE_LL[, FISHERY_GROUP_CODE := "LL"]

# Format Vessel type and gear
ACTIVE_LL[, `:=` (GEAR = "Longline", VESSEL_TYPE = "Longliner")]

# POLE AND LINERS ####
ACTIVE_BB = copy(ACTIVE_BB_RAW)

# Format the year
ACTIVE_BB[, YEAR := as.integer(YEAR)]

ACTIVE_BB[, GEAR := trimws(toupper(GEAR))]
ACTIVE_BB[, VESSEL_TYPE := trimws(toupper(VESSEL_TYPE))]
ACTIVE_BB[, VESSEL_TYPE := trimws(VESSEL_TYPE)]
ACTIVE_BB[, VESSEL_NAME := trimws(VESSEL_NAME)]
ACTIVE_BB[, FLEET_CODE  := trimws(FLEET_CODE)]

# Add gear_code
ACTIVE_BB[, FISHERY_GROUP_CODE := "BB"]

# Harmonize gears
ACTIVE_BB[, `:=` (GEAR = "Pole and line", VESSEL_TYPE = "Baitboat")]

# AGGREGATE ALL VESSEL TYPES ####

ACTIVE_VESSELS = rbindlist(list(ACTIVE_PS[, -c("IOTC_CODE")], ACTIVE_SP[, -c("IOTC_CODE")], ACTIVE_LL[, -c("FLEET_CODE")], ACTIVE_BB[YEAR>2014, -c("FLEET_CODE")]), use.names = TRUE)

l_info("Information on purse seiners consolidated!")